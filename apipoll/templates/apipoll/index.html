{% load staticfiles %}
{% load ganalytics %}
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <META NAME="Description" CONTENT="Is Taylor Swift liking stuff on Tumblr?">

    <link rel="apple-touch-icon" sizes="57x57" href="{% static 'images/apple-touch-icon-57x57.png' %}">
    <link rel="apple-touch-icon" sizes="114x114" href="{% static 'images/apple-touch-icon-114x114.png' %}">
    <link rel="apple-touch-icon" sizes="72x72" href="{% static 'images/apple-touch-icon-72x72.png' %}">
    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'images/apple-touch-icon-144x144.png' %}">
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'images/apple-touch-icon-60x60.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'images/apple-touch-icon-120x120.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'images/apple-touch-icon-76x76.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'images/apple-touch-icon-152x152.png' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/apple-touch-icon-180x180.png' %}">
    <meta name="apple-mobile-web-app-title" content="IsTayOn?">
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}">
    <link rel="icon" type="image/png" href="{% static 'images/favicon-192x192.png' %}" sizes="192x192">
    <link rel="icon" type="image/png" href="{% static 'images/favicon-160x160.png' %}" sizes="160x160">
    <link rel="icon" type="image/png" href="{% static 'images/favicon-96x96.png' %}" sizes="96x96">
    <link rel="icon" type="image/png" href="{% static 'images/favicon-16x16.png' %}" sizes="16x16">
    <link rel="icon" type="image/png" href="{% static 'images/favicon-32x32.png' %}" sizes="32x32">
    <meta name="msapplication-TileColor" content="#36465d">
    <meta name="msapplication-TileImage" content="{% static 'images/mstile-144x144.png' %}">
    <meta name="msapplication-square70x70logo" content="{% static 'images/mstile-70x70.png' %}">
    <meta name="msapplication-square150x150logo" content="{% static 'images/mstile-150x150.png' %}">
    <meta name="msapplication-square310x310logo" content="{% static 'images/mstile-310x310.png' %}">
    <meta name="msapplication-wide310x150logo" content="{% static 'images/mstile-310x150.png' %}">
    <meta name="application-name" content="IsTayOnTumblr?">

    <style type="text/css">
    /* some of this based on styling from isup.me */
    body{background-color:#fff;color:#444;font-family:Arial,Verdana,sans-serif;font-size:62.5%;margin:10% 5% 0 5%;text-align:center;}
    a,a:visited,a:active{color:#444;text-decoration:underline;}
    a:hover{text-decoration:none;}
    ul {list-style-type: none;}

    #footer{margin-top: 2%; margin-bottom: 5%;}
    .avatar{vertical-align:middle; padding-left: 0.5em;}
    #message{font-size: 4em;}
    #details{font-size: 2em; margin-top: 5%;}
    #announcement{font-size: 1.5em; margin-top: 10%;}
    #chart{
        margin-left: auto ;
        margin-right: auto ;
        margin-top: 10%;
        width:400px;
        height:175px;
        display: inline-block;
    }
    .axisLabels {font-size: 2em;}
    .axisLabels {padding-top: 0.5em}
    .flot-tick-label {font-size: 1.75em; padding-right: 0.25em; padding-left: 0.25em;}
    .flot-x-axis {margin-top: 0.5em; }
    .nowrap {white-space: nowrap;}
    .container {text-align: center; width:100%}

    @media (max-width: 600px) {
      #message, #footer {
        width: 100%;
      }
      #footer {
          margin-top: 10%;
      }
      ul {list-style-type: disc;}
      #details {
          text-align: left;
          display: inline-block;
          width: 95%
      }
      #chart {
          display: inline-block;
          width: 90%
      }
    }

    </style>

    <title>{{ title }}</title>
</head>
<body>
    <div id="message">{{ message }}</div>
    <div class="container">
        <div id="details">
            <ul>
                <li>{{ last_liked }}</li>
                <li>{{ count }}</li>
            </ul>
        </div>
    </div>
    <div id="chart"></div>
    <div id="announcement">
        Help get the word out by sharing this with your followers? Reblog <a id="reblog_link">this post</a> or <a id="create_link">make a link post</a>.
    </div>
    <div id="footer">
        Built with love for the Taylor Swift community by <span class="nowrap"><a id="isib_link" href="http://imstillinbeta.tumblr.com"><img class="avatar" src="{{ isib }}"> imstillinbeta</a></span>, with input from <span class="nowrap"><a id="slohf_link" href="http://strangelookonhisface.tumblr.com"><img class="avatar" src="{{ slohf }}"> strangelookonhisface</a></span>. Code at <a href="https://github.com/avaleske/istayon">GitHub</a>.
    </div>

    <!-- plotting things -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'js/flot.concatenated.js' %}"></script>
    <script type="text/javascript">
        var options = {
            yaxis: {
                show: true,
                tickLength:5,
                min:0,
                tickDecimals:0,
                minTickSize: 2,
                ticks:2
            },
            xaxis: {
                tickLength:5,
                axisLabel: 'hours ago',
                ticks: {{ xticks|safe }},
                min: {{ xmin }}
            },
            grid: {
                show: true,
                borderWidth: {top: 0, left: 0, bottom: 0, right: 0}
            },
            series: {
                     curvedLines: {
                              apply: true,
                              active: true,
                              monotonicFit: true
                     }
                 }
        };

        var series1 = {
            color: ['#444'],
            shadowSize: 0,
            data: {{ plot_data|safe }}
        }

        $( document ).ready(function() {
             $.plot($("#chart"), [ series1 ], options);
        });
    </script>

    <script type="text/javascript">
        var tumblr_link_url = "http://istayontumblr.com";
        var tumblr_link_name = "IsTayOnTumblr?";
        var tumblr_link_description = "";

        var create_link = document.getElementById("create_link");
        var reblog_link = document.getElementById("reblog_link");
        var isib_link = document.getElementById("isib_link");
        var slohf_link = document.getElementById("slohf_link");

        if(/iP(ad|hone|od)/.test(navigator.userAgent)){
            create_link.setAttribute("href", "tumblr://x-callback-url/link?title=" + encodeURIComponent(tumblr_link_name) + " &url=" + encodeURIComponent(tumblr_link_url) + "&description=" + encodeURIComponent(tumblr_link_description));
            reblog_link.setAttribute("href", "tumblr://x-callback-url/blog?blogName=imstillinbeta&postID=106189387107")
            slohf_link.setAttribute("href", "tumblr://x-callback-url/blog?blogName=strangelookonhisface")
            isib_link.setAttribute("href", "tumblr://x-callback-url/blog?blogName=imstillinbeta")
        }
        else {
            create_link.setAttribute("href", "http://www.tumblr.com/share/link?url=" + encodeURIComponent(tumblr_link_url) + "&name=" + encodeURIComponent(tumblr_link_name) + "&description=" + encodeURIComponent(tumblr_link_description));
            reblog_link.setAttribute("href", "http://imstillinbeta.tumblr.com/post/106189387107/istayontumblr")
        }
    </script>
    {% ganalytics %}
</body>
</html>